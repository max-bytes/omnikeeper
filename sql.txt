ALTER TABLE "layer" ALTER COLUMN id ADD GENERATED ALWAYS AS IDENTITY (START WITH 1);



select distinct
last_value(a.name) over wnd as max_name,
last_value(a.ci_id) over wnd as max_ci_id,
last_value(a.type) over wnd as max_type,
last_value(a.value) over wnd as max_value, 
last_value(a.activation_time) over wnd as max_activation_time,
last_value(a.layer_id) over wnd as max_layer_id,
last_value(a.state) over wnd as max_state
 from "attribute" a inner join ci c ON a.ci_id = c.id where a.activation_time <= now()
WINDOW wnd AS (
   PARTITION by a.name, a.ci_id, a.layer_id ORDER BY a.activation_time
	ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
 )
 
 
 CREATE TABLE public.changeset
(
    id bigint NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1),
    "timestamp" timestamp with time zone NOT NULL,
    PRIMARY KEY (id)
);

ALTER TABLE public.changeset
    OWNER to postgres;