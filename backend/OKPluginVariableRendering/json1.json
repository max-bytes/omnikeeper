{
  "input_layerset": [
    "overruleing_layer{base_ci.assignmentgroup}",
    "layer1",
    "layer2",
    "assignment_group_layer1"
  ],
  "input_whitelist": [
    "monitoring.vars.*",
    "cmdb.location"
  ],
  "input_blacklist": [
    "monitoring.vars.do_not_include.*"
  ],
  "base_ci": {
    "required_trait": "cmdb.host",
    "input_whitelist": [
      "*"
    ],
    "attribute_mapping": [
      {
        "source": "*",
        "target": "monitoring.vars.{regex_replace(SOURCE, ...)}"
      }
    ],
    "follow_relations": [
      {
        "follow": [
          {
            "predicate": ">has_network_interface",
            "required_trait": "network_interface.admin",
            "input_blacklist": [
              "*"
            ],
            "attribute_mapping": [
              {
                "source": "group1.*",
                "target": "network_interface.admin.{regex_replace(SOURCE, ...)}"
              }
            ]
          },
          {
            "predicate": ">is_attached_to",
            "attribute_mapping": [
              {
                "target": "network_segment.admin.{SOURCE}"
              }
            ]
          }
        ]
      },
      {
        "follow": [
          {
            "predicate": ">has_network_interface",
            "required_trait": "network_interface.prod",
            "attribute_prefix": "network_interface.prod."
          },
          {
            "predicate": ">is_attached_to",
            "attribute_prefix": "network_segment.prod.",
            "attribute_mapping": [
              {
                "source": "group1.*",
                "target": "network_segment.prod.{SOURCE}"
              },
              {
                "source": "group2.*",
                "target": "network_segment.prod.info_only.{SOURCE}"
              },
              {
                "source": "group2.*",
                "target": "network_segment.prod.never_filled.{SOURCE}"
              },
              {
                "source": "network_segment.prod.*",
                "target": "renamed.{SOURCE}"
              }
            ]
          }
        ]
      },
      {
        "follow": [
          {
            "predicate": ">belongs_to_customer",
            "attribute_prefix": "customer."
          }
        ]
      },
      {
        "follow": [
          {
            "predicate": ">belongs_to_assignment_group",
            "attribute_prefix": "assignment_group."
          }
        ]
      }
    ]
  }
}